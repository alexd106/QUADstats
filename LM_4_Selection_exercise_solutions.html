<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise Solutions</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">QUADstats</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="exercises.html">
    <span class="fa fa-book"></span>
     
    Exercises
  </a>
</li>
<li>
  <a href="exercise_solutions.html">
    <span class="fa fa-book"></span>
     
    Exercise Solutions
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/ezFyn6bMVYCt75rB6">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="https://www.quadrat.ac.uk/">
        <span class="fa fa-chrome"></span>
         
        QUADRAT
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/BI5009">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise Solutions</h1>

</div>


<p> </p>
<div id="exercise-model-selection-with-the-loyn-data" class="section level1">
<h1>Exercise: Model selection with the Loyn data</h1>
<p> </p>
<p>This exercise revisits the Loyn data, asking if a better model for the data could be achieved by including additional predictors, and applying a systematic model selection procedure.</p>
<p> </p>
<ol style="list-style-type: decimal">
<li>As in previous exercises, either create a new R script (perhaps call it linear_model_4) or continue with your previous R script in your RStudio Project. Again, make sure you include any metadata you feel is appropriate (title, description of task, date of creation etc) and don’t forget to comment out your metadata with a <code>#</code> at the beginning of the line.</li>
</ol>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Import the data file ‘loyn.txt’ into R and take a look at the structure of this dataframe using the <code>str()</code> function. It seems so far that the abundance of birds <code>ABUND</code> is explained by both the area of the patch <code>LOGAREA</code>, and the grazing intensity <code>FGRAZE</code>, but some observations are still poorly fitted by the model. Here we will be using all the explanatory variables to explain variation in bird density. If needed, remind yourself of your data exploration you conducted in Section 1. Do any of the variables need transforming? If so, what transformation did you apply? Add the required variables to the data set.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>loyn &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;./data/loyn.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>                   <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">str</span>(loyn)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">## &#39;data.frame&#39;:    56 obs. of  8 variables:</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">##  $ Site   : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">##  $ ABUND  : num  5.3 2 1.5 17.1 13.8 14.1 3.8 2.2 3.3 3 ...</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">##  $ AREA   : num  0.1 0.5 0.5 1 1 1 1 1 1 1 ...</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">##  $ DIST   : int  39 234 104 66 246 234 467 284 156 311 ...</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">##  $ LDIST  : int  39 234 311 66 246 285 467 1829 156 571 ...</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">##  $ YR.ISOL: int  1968 1920 1900 1966 1918 1965 1955 1920 1965 1900 ...</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">##  $ GRAZE  : int  2 5 5 3 5 3 5 5 4 5 ...</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">##  $ ALT    : int  160 60 140 160 140 130 90 60 130 130 ...</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>loyn<span class="op">$</span>FGRAZE &lt;-<span class="st"> </span><span class="kw">factor</span>(loyn<span class="op">$</span>GRAZE)</span>
<span id="cb1-14"><a href="#cb1-14"></a>loyn<span class="op">$</span>LOGAREA &lt;-<span class="st"> </span><span class="kw">log10</span>(loyn<span class="op">$</span>AREA)</span>
<span id="cb1-15"><a href="#cb1-15"></a>loyn<span class="op">$</span>LOGDIST &lt;-<span class="st"> </span><span class="kw">log10</span>(loyn<span class="op">$</span>DIST)</span>
<span id="cb1-16"><a href="#cb1-16"></a>loyn<span class="op">$</span>LOGLDIST &lt;-<span class="st"> </span><span class="kw">log10</span>(loyn<span class="op">$</span>LDIST)</span></code></pre></div>
<p><br />
</p>
<ol start="3" style="list-style-type: decimal">
<li>We assume that all the predictors have been collected by the authors <em>because</em> they are believed to be biologically relevant for explaining bird abundance. However, it is a good idea to pause and think what might be relevant or not-so relevant or partly redundant and why, before even exploring the relationships with bird abundance (even graphically). You could do this in a table format, and include a hypothetical ranking of importance. Is there anything that limits your ability to fill that table?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Example:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Rank  |   Predictor   |   Biological effect</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># 1     |   LOGAREA   | Large patches containing proportionally</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#                     more core habitat: enable persistence of</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#                     species with larger home ranges. </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># 3     |   LOGDIST   | ?</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># ?     |   LOGLDIST    |   ?</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># 2     |   YR.ISOL   | ?</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># ?     |   ALT         |   ?</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># ?     |   FGRAZE    | ?</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># expect to come up with different predictions!</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># The main limitation is our lack of insider and expert knowledge of the</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co"># study system and area, of course.</span></span></code></pre></div>
<p><br />
</p>
<ol start="4" style="list-style-type: decimal">
<li>Start with a graphical exploration of the relationships between predictors and between predictors and response. A pair-plot with <code>pairs()</code> is a very effective way of doing this when the number of variables is not too large. Hints:</li>
</ol>
<ul>
<li>restrict the plot to the variables you actually need</li>
<li>an effective way of doing this is to store the names of the variables of interest in a vector <code>VOI&lt;- c("Var1", "Var2", ...)</code></li>
<li>and then use the naming method for subsetting the data set <code>Mydata[, VOI]</code></li>
</ul>
<p> </p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>VOI&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ABUND&quot;</span>, <span class="st">&quot;LOGAREA&quot;</span>, <span class="st">&quot;LOGDIST&quot;</span>, <span class="st">&quot;LOGLDIST&quot;</span>, <span class="st">&quot;YR.ISOL&quot;</span>, <span class="st">&quot;ALT&quot;</span>, <span class="st">&quot;FGRAZE&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">pairs</span>(loyn[, VOI])</span></code></pre></div>
<p><img src="LM_4_Selection_exercise_solutions_files/figure-html/Q4-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># There is variable degrees of imbalance (correlation) between predictors</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># such as:</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># LOGAREA and FGRAZE, </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># LOGDIST and LOGLDIST (quite expected), </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># YR.ISOL and other variables like LOGAREA or FGRAZE, </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># LOGAREA and ALT, </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># but overall a decent spread of observations across these pairs of predictors.</span></span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># The relationship between the response variable ABUND and all the predictors</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># is visible in the top row:</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#  Some potential correlations present like with LOGAREA (positive), </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># YR.ISOl (positive), maybe ALT (positive) and FGRAZE (negative).</span></span></code></pre></div>
<p><br />
</p>
<ol start="5" style="list-style-type: decimal">
<li>Start with a model of ABUND containing all predictors. Don’t include any interactions at this point, we will simplify the exercise by including only the main effects (unless you have identified some interactions that you expect to be important?).</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>M1 &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">+</span><span class="st"> </span>LOGDIST <span class="op">+</span><span class="st"> </span>LOGLDIST <span class="op">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">                 </span>YR.ISOL <span class="op">+</span><span class="st"> </span>ALT <span class="op">+</span><span class="st"> </span>FGRAZE,</span>
<span id="cb5-3"><a href="#cb5-3"></a>         <span class="dt">data =</span> loyn)</span></code></pre></div>
<p><br />
</p>
<ol start="6" style="list-style-type: decimal">
<li>Obtain summaries of the model output using the <code>anova()</code> and <code>summary()</code> functions. Make sure you understand the difference between these two summaries, and the mathematical and biological interpretation of the different coefficients (i.e. would you be able to reconstruct and use the model formula to make predictions? In doubt, try it and seek assistance!).</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">anova</span>(M1)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">## </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">## Response: ABUND</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">## LOGAREA    1 3471.0  3471.0 93.1303 1.247e-12 ***</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">## LOGDIST    1   65.5    65.5  1.7568  0.191565    </span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">## LOGLDIST   1  136.5   136.5  3.6630  0.061868 .  </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">## YR.ISOL    1  458.8   458.8 12.3109  0.001019 ** </span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">## ALT        1   78.2    78.2  2.0979  0.154281    </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">## FGRAZE     4  413.5   103.4  2.7736  0.037992 *  </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">## Residuals 46 1714.4    37.3                      </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">## ---</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="kw">summary</span>(M1)</span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">## </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">## Call:</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">## lm(formula = ABUND ~ LOGAREA + LOGDIST + LOGLDIST + YR.ISOL + </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">##     ALT + FGRAZE, data = loyn)</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">## </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">## Residuals:</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">## -15.8992  -2.7245  -0.2772   2.7052  11.2811 </span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">## </span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">## Coefficients:</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">## (Intercept)  36.68025  115.16348   0.319   0.7515    </span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">## LOGAREA       6.83303    1.50330   4.545 3.97e-05 ***</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">## LOGDIST       0.33286    2.74778   0.121   0.9041    </span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">## LOGLDIST      0.79765    2.13759   0.373   0.7107    </span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">## YR.ISOL      -0.01277    0.05803  -0.220   0.8267    </span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">## ALT           0.01070    0.02390   0.448   0.6565    </span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">## FGRAZE2       0.52851    3.25221   0.163   0.8716    </span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co">## FGRAZE3       0.06601    2.95871   0.022   0.9823    </span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">## FGRAZE4      -1.24877    3.19838  -0.390   0.6980    </span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">## FGRAZE5     -12.47309    4.77827  -2.610   0.0122 *  </span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">## ---</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">## </span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co">## Residual standard error: 6.105 on 46 degrees of freedom</span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">## Multiple R-squared:  0.7295, Adjusted R-squared:  0.6766 </span></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">## F-statistic: 13.78 on 9 and 46 DF,  p-value: 2.115e-10</span></span></code></pre></div>
<p><br />
</p>
<ol start="7" style="list-style-type: decimal">
<li>Check for collinearity using the <code>vif()</code> function in the <code>car</code> package.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(car)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">vif</span>(M1)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">##              GVIF Df GVIF^(1/(2*Df))</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">## LOGAREA  2.201116  1        1.483616</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">## LOGDIST  1.907874  1        1.381258</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">## LOGLDIST 2.228456  1        1.492801</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">## YR.ISOL  3.252591  1        1.803494</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">## ALT      1.597400  1        1.263883</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">## FGRAZE   7.925036  4        1.295314</span></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co"># potential problem with FGRAZE (as seen from data exploration) with LOGAREA</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co"># or YR.ISOL</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># ignore for the moment</span></span></code></pre></div>
<p><br />
</p>
<ol start="8" style="list-style-type: decimal">
<li>Is everything significant? Which of the summaries do you prefer to use, and why?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">anova</span>(M1)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">## </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">## Response: ABUND</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">## LOGAREA    1 3471.0  3471.0 93.1303 1.247e-12 ***</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">## LOGDIST    1   65.5    65.5  1.7568  0.191565    </span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">## LOGLDIST   1  136.5   136.5  3.6630  0.061868 .  </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">## YR.ISOL    1  458.8   458.8 12.3109  0.001019 ** </span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">## ALT        1   78.2    78.2  2.0979  0.154281    </span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">## FGRAZE     4  413.5   103.4  2.7736  0.037992 *  </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">## Residuals 46 1714.4    37.3                      </span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">## ---</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="kw">summary</span>(M1)</span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">## </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">## Call:</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">## lm(formula = ABUND ~ LOGAREA + LOGDIST + LOGLDIST + YR.ISOL + </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">##     ALT + FGRAZE, data = loyn)</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">## </span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">## Residuals:</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">## -15.8992  -2.7245  -0.2772   2.7052  11.2811 </span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">## </span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">## Coefficients:</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">## (Intercept)  36.68025  115.16348   0.319   0.7515    </span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">## LOGAREA       6.83303    1.50330   4.545 3.97e-05 ***</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">## LOGDIST       0.33286    2.74778   0.121   0.9041    </span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">## LOGLDIST      0.79765    2.13759   0.373   0.7107    </span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">## YR.ISOL      -0.01277    0.05803  -0.220   0.8267    </span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">## ALT           0.01070    0.02390   0.448   0.6565    </span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">## FGRAZE2       0.52851    3.25221   0.163   0.8716    </span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">## FGRAZE3       0.06601    2.95871   0.022   0.9823    </span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">## FGRAZE4      -1.24877    3.19838  -0.390   0.6980    </span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">## FGRAZE5     -12.47309    4.77827  -2.610   0.0122 *  </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">## ---</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">## </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">## Residual standard error: 6.105 on 46 degrees of freedom</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">## Multiple R-squared:  0.7295, Adjusted R-squared:  0.6766 </span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">## F-statistic: 13.78 on 9 and 46 DF,  p-value: 2.115e-10</span></span>
<span id="cb8-43"><a href="#cb8-43"></a></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co"># ANOVA allows testing overall significance for categorical predictors,</span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co"># which is more handy. </span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co"># But the results of this ANOVA depend on the order of the variables,</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co"># which is arbitrary here.</span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co"># We could change the order but there are too many possible permutations</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co"># Summary p-values don&#39;t suffer that problem but test different hypotheses</span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co"># It would be useful to use an ANOVA that doesn&#39;t depend on the order</span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co"># of inclusion of the variables</span></span></code></pre></div>
<p><br />
</p>
<ol start="9" style="list-style-type: decimal">
<li>If not, perform a model selection step using <code>drop1()</code> for choosing which single term is the best candidate for deletion (remember to use the test = ”F” argument to perform F tests). What is that term?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">drop1</span>(M1, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">## Single term deletions</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## Model:</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## ABUND ~ LOGAREA + LOGDIST + LOGLDIST + YR.ISOL + ALT + FGRAZE</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">##          Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)    </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## &lt;none&gt;                1714.4 211.60                     </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## LOGAREA   1    770.01 2484.4 230.38 20.6603 3.97e-05 ***</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">## LOGDIST   1      0.55 1715.0 209.62  0.0147  0.90411    </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">## LOGLDIST  1      5.19 1719.6 209.77  0.1392  0.71075    </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">## YR.ISOL   1      1.81 1716.2 209.66  0.0485  0.82675    </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">## ALT       1      7.47 1721.9 209.85  0.2004  0.65650    </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">## FGRAZE    4    413.50 2127.9 215.70  2.7736  0.03799 *  </span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">## ---</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># LOGDIST is the least significant, hence makes the least </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co"># contribution to the variability explained by the model, </span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co"># with respect to the number of degrees of freedom it uses (1)</span></span></code></pre></div>
<p><br />
</p>
<ol start="10" style="list-style-type: decimal">
<li>Update the model and repeat single term deletions with <code>drop1()</code>, until there are no longer any non-significant terms.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>M2 &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">+</span><span class="st"> </span>LOGLDIST <span class="op">+</span><span class="st"> </span><span class="co"># removing LOGDIST here</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">                 </span>YR.ISOL <span class="op">+</span><span class="st"> </span>ALT <span class="op">+</span><span class="st"> </span>FGRAZE,</span>
<span id="cb10-3"><a href="#cb10-3"></a>         <span class="dt">data =</span> loyn)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># or use the shortcut:</span></span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a>M2&lt;-<span class="st"> </span><span class="kw">update</span>(M1, <span class="dt">formula =</span> . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>LOGDIST) <span class="co"># &quot;.&quot; means all previous variables</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="kw">drop1</span>(M2, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">## Single term deletions</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">## </span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">## Model:</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">## ABUND ~ LOGAREA + LOGLDIST + YR.ISOL + ALT + FGRAZE</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">##          Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    </span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">## &lt;none&gt;                1715.0 209.62                      </span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">## LOGAREA   1    769.64 2484.6 228.38 21.0925 3.285e-05 ***</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">## LOGLDIST  1      8.57 1723.5 207.90  0.2349   0.63015    </span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">## YR.ISOL   1      1.73 1716.7 207.68  0.0474   0.82864    </span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">## ALT       1      7.07 1722.0 207.85  0.1938   0.66177    </span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">## FGRAZE    4    413.28 2128.2 213.71  2.8315   0.03482 *  </span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">## ---</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co"># YR.ISOL is now the least significant, hence makes the least </span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># contribution to the variability explained by the model, </span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co"># with respect to the number of degrees of freedom it uses (1)</span></span>
<span id="cb10-26"><a href="#cb10-26"></a></span>
<span id="cb10-27"><a href="#cb10-27"></a>M3 &lt;-<span class="st"> </span><span class="kw">update</span>(M2, <span class="dt">formula =</span> . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>YR.ISOL)</span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="kw">drop1</span>(M3, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">## Single term deletions</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">## </span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">## Model:</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">## ABUND ~ LOGAREA + LOGLDIST + ALT + FGRAZE</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">##          Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    </span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">## &lt;none&gt;                1716.7 207.68                      </span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">## LOGAREA   1    790.20 2506.9 226.88 22.0943 2.218e-05 ***</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">## LOGLDIST  1      8.32 1725.0 205.95  0.2327 0.6317501    </span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">## ALT       1      9.71 1726.4 205.99  0.2715 0.6047169    </span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">## FGRAZE    4    848.77 2565.5 222.18  5.9330 0.0005808 ***</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co">## ---</span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-41"><a href="#cb10-41"></a></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co"># LOGLDIST and ALT now the least significant. Choosing on the basis of</span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co"># p-values this similar is really quite arbitrary, so would be best guided</span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co"># by expert knowledge if we have it.</span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co"># in the absence of strong a-priori expertise, we&#39;ll go for LOGLDIST</span></span>
<span id="cb10-46"><a href="#cb10-46"></a></span>
<span id="cb10-47"><a href="#cb10-47"></a>M4 &lt;-<span class="st"> </span><span class="kw">update</span>(M3, <span class="dt">formula =</span> . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>LOGLDIST)</span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="kw">drop1</span>(M4, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co">## Single term deletions</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">## </span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">## Model:</span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co">## ABUND ~ LOGAREA + ALT + FGRAZE</span></span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="co">##         Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    </span></span>
<span id="cb10-54"><a href="#cb10-54"></a><span class="co">## &lt;none&gt;               1725.0 205.95                      </span></span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="co">## LOGAREA  1   1130.78 2855.8 232.18 32.1203 7.582e-07 ***</span></span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="co">## ALT      1      5.37 1730.4 204.12  0.1526 0.6977551    </span></span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="co">## FGRAZE   4    914.23 2639.3 221.76  6.4923 0.0002833 ***</span></span>
<span id="cb10-58"><a href="#cb10-58"></a><span class="co">## ---</span></span>
<span id="cb10-59"><a href="#cb10-59"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-60"><a href="#cb10-60"></a></span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="co"># and finally drop ALT from the model</span></span>
<span id="cb10-62"><a href="#cb10-62"></a>M5 &lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">+</span><span class="st"> </span>FGRAZE, <span class="dt">data =</span> loyn) <span class="co"># writing model in full for clarity</span></span>
<span id="cb10-63"><a href="#cb10-63"></a><span class="kw">drop1</span>(M5, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb10-64"><a href="#cb10-64"></a><span class="co">## Single term deletions</span></span>
<span id="cb10-65"><a href="#cb10-65"></a><span class="co">## </span></span>
<span id="cb10-66"><a href="#cb10-66"></a><span class="co">## Model:</span></span>
<span id="cb10-67"><a href="#cb10-67"></a><span class="co">## ABUND ~ LOGAREA + FGRAZE</span></span>
<span id="cb10-68"><a href="#cb10-68"></a><span class="co">##         Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    </span></span>
<span id="cb10-69"><a href="#cb10-69"></a><span class="co">## &lt;none&gt;               1730.4 204.12                      </span></span>
<span id="cb10-70"><a href="#cb10-70"></a><span class="co">## LOGAREA  1    1153.8 2884.2 230.73 33.3405 4.901e-07 ***</span></span>
<span id="cb10-71"><a href="#cb10-71"></a><span class="co">## FGRAZE   4    1136.5 2866.9 224.40  8.2101 3.598e-05 ***</span></span>
<span id="cb10-72"><a href="#cb10-72"></a><span class="co">## ---</span></span>
<span id="cb10-73"><a href="#cb10-73"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-74"><a href="#cb10-74"></a><span class="co"># All significant: no more terms to drop. Here we are, back to a</span></span>
<span id="cb10-75"><a href="#cb10-75"></a><span class="co"># familiar version of the model!</span></span></code></pre></div>
<p><br />
</p>
<ol start="11" style="list-style-type: decimal">
<li>At this stage, you should validate this model, if it is our final model. Hint: you probably have done it for this model already, in previous exercises.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">plot</span>(M5)</span></code></pre></div>
<p><img src="LM_4_Selection_exercise_solutions_files/figure-html/Q11-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co"># Seen that already!</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># For info:</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># To test the normality of residuals assumption we use the Normal Q-Q plot. </span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># The central residuals are not too far from the Q-Q line but the extremes</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co"># are too extreme (the tails of the distribution are too long).</span></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># Some observations, both high and low, are poorly explained by the model.</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># The plot of the residuals against the fitted values suggests</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co"># these extreme residuals happen for intermediate fitted values.</span></span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co"># Looking at the homogeneity of variance assumption</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># (Residuals vs Fitted and Scale-Location plot),</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co"># the graphs are mostly messy, with no clear pattern emerging.</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># There is a hint of smaller variance with the lowest fitted values,</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co"># which is not ideal.</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co"># This could mean that the homogeneity of variance assumption is not met</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># (i.e. the variances are not the same). </span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co"># The observations with the highest leverage don&#39;t appear to be overly</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co"># influential, based on Cook&#39;s distances in the Residuals vs Leverage plot.  </span></span>
<span id="cb12-21"><a href="#cb12-21"></a></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co"># ABUND being bounded by zero, it wouldn&#39;t be too surprising that the</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># variance increases with the mean abundance.</span></span></code></pre></div>
<p><br />
</p>
<ol start="12" style="list-style-type: decimal">
<li>Let’s now get back to a previous model <code>birds.inter.1 &lt;- lm(ABUND ~ FGRAZE * LOGAREA)</code>, which we left with non-significant terms. Do you need to use <code>drop1()</code> to simplify that model?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># No we don&#39;t, in this simple case:</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># when an interaction is significant, the main effects should be left</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># in irrespective of significance, because the interaction cannot be</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># interpreted correctly without its main effect.</span></span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># Likewise, when an interaction is non-significant it must go first,</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># and only then the evidence for the main effects can be assessed.</span></span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co"># Because R always includes interactions *after* their main effects</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># in the models, the anova of the model returns the same result as drop1, </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co"># in our simple model which has no interactions with other terms</span></span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co"># Demo:</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>M6&lt;-<span class="st"> </span><span class="kw">lm</span>(ABUND <span class="op">~</span><span class="st"> </span>LOGAREA <span class="op">*</span><span class="st"> </span>FGRAZE, <span class="dt">data =</span> loyn) <span class="co"># writing the model in full for clarity</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="kw">anova</span>(M6)</span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">## </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">## Response: ABUND</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">##                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">## LOGAREA         1 3471.0  3471.0 108.1284 1.158e-13 ***</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">## FGRAZE          4 1136.5   284.1   8.8514 2.187e-05 ***</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">## LOGAREA:FGRAZE  4  253.8    63.4   1.9764    0.1139    </span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">## Residuals      46 1476.6    32.1                       </span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">## ---</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="kw">drop1</span>(M6, <span class="dt">test=</span> <span class="st">&quot;F&quot;</span>) <span class="co"># drop1 is clever enough that it doesn&#39;t let you</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">## Single term deletions</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">## </span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">## Model:</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">## ABUND ~ LOGAREA * FGRAZE</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">##                Df Sum of Sq    RSS    AIC F value Pr(&gt;F)</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">## &lt;none&gt;                      1476.6 203.24               </span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">## LOGAREA:FGRAZE  4    253.77 1730.4 204.12  1.9764 0.1139</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co"># see the p-values for the main effect, in the presence of their interaction.</span></span></code></pre></div>
<p><br />
</p>
<ol start="13" style="list-style-type: decimal">
<li>What is the final model then? What are the final conclusions or lessons you take away from this analysis of the Loyn data?</li>
</ol>
<p><br />
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Biologically: what we already found out in the previous LM exercises:</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># There is a significant effect of grazing levels, especially the highest</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># level with a negative effect on bird abundance</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># There is a significant positive effect of patch area, too.</span></span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># The relative importance of patch area and grazing is not clear, as these</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co"># are correlated, with smaller patches also having higher grazing intensity</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co"># on average, and larger patches lower grazing intensity.</span></span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co"># Some observations are poorly predicted (fitted) using the set of</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co"># available predictors.</span></span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co"># Methodologically:</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co"># Doing model selection is difficult without an intrinsic / expert knowledge</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co"># of the system, to guide what variables to include.</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co"># Even with this dataset, many more models could have been formulated.</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co"># For example, for me, theory would have suggested to test an interaction </span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co"># between YR.ISOL and LOGDIST (or LOGLDIST?), </span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co"># because LOGDIST will affect dispersal, </span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co"># and the time since isolation of the patch may affect how important</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co"># dispersal has been to maintain or rescue populations </span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co"># (for recently isolated patches, dispersal, and hence distance to nearest</span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co"># patches may have a less important effect)</span></span></code></pre></div>
<p> </p>
<p>End of the Linear model with interactive continuous and categorical predictors exercise</p>
<p><br />
</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
