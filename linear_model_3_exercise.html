<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercises</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">QUADstats</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-book"></span>
         
        Exercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-book"></span>
         
        Exercise Solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/hdSRd368iP6MFUum7">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="https://www.quadrat.ac.uk/">
        <span class="fa fa-chrome"></span>
         
        QUADRAT
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/QUADstats">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercises</h1>

</div>


<p> </p>
<div
id="linear-model-with-an-interaction-between-a-continuous-and-a-categorical-variable"
class="section level2">
<h2>Linear model with an interaction between a continuous and a
categorical variable</h2>
<p> </p>
<p>This exercise builds on the previous exercises where you fitted a
linear model with either a single continuous explanatory variable or a
single categorical explanatory variable. In this exercise you will fit a
model with both a continuous and categorical explanatory variable and
allow their effects to interact (i.e. the effect of one explanatory
variable on the response variable changes with the value of the another
explanatory variable). This is the third of four complementary
exercises, based on the <code>loyn</code> data set.</p>
<p> </p>
<p>1. As in previous exercises, either create a new R script (perhaps
call it linear_model_3) or continue with your previous R script in your
RStudio Project. Again, make sure you include any metadata you feel is
appropriate (title, description of task, date of creation etc) and don’t
forget to comment out your metadata with a <code>#</code> at the
beginning of the line.</p>
<p> </p>
<p>2. Import the data file ‘loyn.txt’ into R and take a look at the
structure of this dataframe using the <code>str()</code> function. We
know that the abundance of birds <code>ABUND</code> increases with the
log<sub>10</sub> transformed area of the forest patch
(<code>LOGAREA</code> variable). We also know that bird abundance
changes with the grazing intensity (<code>FGRAZE</code> variable) with
forest patches with higher grazing intensity having fewer birds on
average. But how do these effects combine together? Would a small patch
with low grazing intensity have more birds than a larger patch with high
grazing intensity? Could the fit of the <code>ABUND ~ LOGAREA</code>
model for the large patches be improved if we accounted for grazing
intensity in the patches?</p>
<p> </p>
<p> </p>
<p>3. As previously we want to treat <code>AREA</code> as a
log<sub>10</sub>-transformed area to limit the influence of the couple
of disproportionately large patches, and <code>GRAZE</code> as a
categorical variable with five levels. So the first thing we need to do
is create the corresponding variables in the <code>loyn</code>
dataframe, called <code>LOGAREA</code> and <code>FGRAZE</code>.</p>
<p> </p>
<p> </p>
<p>4. Explore the relationship between bird abundance and log
transformed forest patch area for each level of grazing. You could
manually create a separate plot for each graze level but it’s more
efficient to use a conditional scatter plot (aka coplot, see <a
href="https://intro2r.com/simple-base-r-plots.html#coplots">section
4.2.6</a> of the R book or the help page for the function
<code>coplot()</code>). A coplot lets you visualise the relationship
between <code>ABUND</code> and <code>LOGAREA</code> for each level of
<code>FGRAZE</code>, with <code>FGRAZE</code> levels increasing from the
bottom-left panel (Graze level 1) to the top-right panel (Graze level
5). What patterns do you see? Is it okay to assume that the relationship
between <code>ABUND</code> and <code>LOGAREA</code> is the same for all
grazing levels or does the relationship change? This is effectively
asking if the slopes of the relationship between <code>ABUND</code> and
<code>LOGAREA</code> are different for each <code>FGRAZE</code> level -
this is called an interaction.</p>
<p> </p>
<p> </p>
<p>5. Fit an appropriate linear model in R to explain the variation in
the response variable <code>ABUND</code> with the explanatory variables
<code>LOGAREA</code> and <code>FGRAZE</code>. Also include the
interaction between <code>LOGAREA</code> and <code>FGRAZE</code>. Hint:
<code>:</code> is the interaction symbol! Remember to use the
<code>data =</code> argument. Assign this linear model to an
appropriately named object, like <code>birds.inter.1</code>. Optional:
Can you remember how to specify the model using the ‘shortcut’ version
(with <code>*</code>) instead?</p>
<p> </p>
<p> </p>
<p>6. As conscientious modellers, let’s first check the assumptions of
our linear model by creating plots of the residuals. Remember, that you
can split your plotting device into 2 rows and 2 columns using the
<code>par()</code> function before you create the plots. Check each of
the assumptions using these plots and report whether your model meets
these assumptions.</p>
<p> </p>
<p> </p>
<p>7. Use the <code>anova()</code> function to produce the ANOVA table
of your linear model. Remember, this ANOVA table is based on sequential
sums of squares (the order of the explanatory variables matters). The
only P value that we should interpret is the one that occurs in the
second to last row of the table (the one above ‘Residuals’). This is the
interaction term between <code>FGRAZE</code> and <code>LOGAREA</code>
(<code>FGRAZE:LOGAREA</code>). What is the null hypothesis associated
with this interaction term? Do we reject or fail to reject this
hypothesis? What is the biological interpretation of this interaction
term? Can we say anything about the hypotheses for the main effects of
<code>FGRAZE</code> or <code>LOGAREA</code>?</p>
<p>8. OK, now for the part you all know and love! Use the
<code>summary()</code> function on your model object to produce the
table of parameter estimates. Using this output, take each line in turn
and answer the following questions: (A) what does this parameter
estimate? (B) What is the biological interpretation of the corresponding
estimate? (C) What is the null hypothesis associated with it? (D) Do you
reject or fail to reject this hypothesis? Also compare the multiple
R<sup>2</sup> from this model the models you created in the previous two
exercises. I encourage you to get someone to discuss your answers with
you if you are confused :).</p>
<p> </p>
<p> </p>
<p>9. Right, now hang onto your hat! Let’s plot the predictions from
your model to figure out how it really fits the data (and help us
understand the output from the <code>summary()</code> function :).
Here’s a general recipe, using the <code>predict()</code> function.</p>
<ul>
<li>plot the raw data, using a different colour for points from each
<code>FGRAZE</code> level</li>
<li>for each <code>FGRAZE</code> level in turn:</li>
<li>create a sequence of <code>LOGAREA</code> from the minimum value to
the maximum within the grazing level (unless you wish to predict outside
the range of observed values, probably best not too!).</li>
<li>store it in a data frame (e.g. <code>dat4pred</code>) containing the
variables <code>FGRAZE</code> and <code>LOGAREA.</code> Remember that
<code>FGRAZE</code> is a factor, so its value need to be placed in
quotes.</li>
<li>Create a vector of predicted bird abundances using our new dataframe
using the <code>predict()</code> function.</li>
<li>Add the predicted to your plot using the <code>lines()</code>
function with the appropriate colours.</li>
</ul>
<p>See the script below, for one of many ways of doing this. Now this
might seem like a huge amount of code just to plot your predicted values
(and admittedly it is!) but most of the code is just repeated for each
level of graze. Just work through it slowly and logically and hopefully
it will make sense (please ask if you are confused). I will also show
you some alternative (easier?) ways to do this below.</p>
<p> </p>
<p><img src="linear_model_3_exercise_files/figure-html/Q9a-1.png" width="672" /></p>
<p> </p>
<p><strong>(Optional, for the geeks)</strong> Alternative method, using
a loop. Just keep this code in case you ever want to do something like
this in the future.</p>
<p> </p>
<p><img src="linear_model_3_exercise_files/figure-html/Q9b-1.png" width="672" /></p>
<p><strong>(Optional, for the lazy!)</strong> And, if you want an even
easier way, then we can use the <code>ggolot2</code> package. Note: you
will need to install the <code>ggplot2</code> package first if you don’t
already have it.</p>
<p> </p>
<p><img src="linear_model_3_exercise_files/figure-html/Q9c-1.png" width="672" /></p>
<p> </p>
<p>End of the Linear model with continuous and categorical explanatory
variables exercise</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
