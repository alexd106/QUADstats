<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercises</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">QUADstats</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-book"></span>
         
        Exercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-book"></span>
         
        Exercise Solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSfJw6izeHZqnhujfmz5Dgs0GLDBKplQykCPmKuPHuJWigk8ag/viewform?usp=sf_link">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="https://www.quadrat.ac.uk/">
        <span class="fa fa-chrome"></span>
         
        QUADRAT
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/BI5009">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercises</h1>

</div>


<p> </p>
<div id="exercise-linear-model-with-continuous-and-categorical-explanatory-variables" class="section level1">
<h1>Exercise: Linear model with continuous and categorical explanatory variables</h1>
<p> </p>
<p>This exercise builds on the linear model with one continuous explanatory variable, and the linear model with one categorical explanatory variable, by adding these two sources of variation in the same model. The first part of the exercise will explore fitting an ‘additive’ model and the second part fitting a model with an interaction term.</p>
<p> </p>
<div id="part-1-linear-model-with-additive-explanatory-variables" class="section level3">
<h3>Part 1: Linear model with additive explanatory variables</h3>
<p> </p>
<p>1. As in previous exercises, either create a new R script (perhaps call it linear_model_3) or continue with your previous R script in your RStudio Project. Again, make sure you include any metadata you feel is appropriate (title, description of task, date of creation etc) and don’t forget to comment out your metadata with a <code>#</code> at the beginning of the line.</p>
<p> </p>
<p>2. Import the data file ‘loyn.txt’ into R and take a look at the structure of this dataframe using the <code>str()</code> function. We know that the abundance of birds <code>ABUND</code> increases quickly with the area of the patch <code>LOGAREA</code>, and more slowly for the larger patches. We now also know that bird abundance changes in a non-linear way with the grazing intensity <code>FGRAZE</code>. But how do these effects combine together? Would a small patch with low grazing intensity have more birds than a larger patch with high grazing intensity? Could the poor fit of the <code>ABUND ~ LOGAREA</code> model for the large patches be improved if we accounted for grazing intensity in the patches?</p>
<p> </p>
<p> </p>
<p>3. As previously we want to treat <code>AREA</code> as a log-transformed area to limit the influence of the few disproportionately large patches, and <code>GRAZE</code> as a categorical variable with five levels. So the first thing we need to do is create the corresponding variables in the loyn dataframe, called <code>LOGAREA</code> and <code>FGRAZE</code>.</p>
<p> </p>
<p> </p>
<p>4. Explore the relationship between grazing and patch area, using a scatterplot. Hint: you may want to use <code>GRAZE</code> rather than <code>FGRAZE</code> for this. Is there any variability in patch area within each grazing level? Is the sampling design balanced, i.e., is the whole range of patch areas evenly represented at each grazing level?</p>
<p> </p>
<p> </p>
<p>5. You could explore the joint effect of <code>FGRAZE</code> and <code>LOGAREA</code> on <code>ABUND</code>, using panel plots. Hint: See the function <code>coplot</code> in the Data exploration lecture, and/or the help page for <code>coplot</code>. Factor levels increase from the bottom-left panel to the top-right panel. What pattern do you see? What do you expect your model results to look like?</p>
<p> </p>
<p> </p>
<p>6. Fit an appropriate linear model in R to explain the variation in the response variable, <code>ABUND</code> with the explanatory variables <code>LOGAREA</code> and <code>FGRAZE</code> acting additively. Hint: combine explanatory variables using a <code>+</code> symbol. Remember to use the <code>data =</code> argument. Assign this linear model to an appropriately named object, like <code>birds.add.1</code>.</p>
<p> </p>
<p> </p>
<p>7. Produce the ANOVA table using the <code>anova()</code> function on the model object. What null hypotheses are being tested? Hint: the <code>anova()</code> function performs sequential tests. Do you reject or fail to reject the null hypotheses?</p>
<p> </p>
<p> </p>
<p>8. Use the <code>summary()</code> function on the model object to produce the table of parameter estimates. Using this output take each line in turn and answer the following questions: (A) what does this parameter represent? (B) What is the biological interpretation of the corresponding estimate? (C) What is the null hypothesis associated with it? (D) Do you reject or fail to reject this hypothesis?</p>
<p> </p>
<p> </p>
<p>9. Now let’s check the assumptions of your linear model by creating plots of the residuals from the model. Remember, that you can split your plotting device into 2 rows and 2 columns using the <code>par()</code> function before you create the plots. Check each of the assumptions using these plots and report whether your model meets these assumptions.</p>
<p> </p>
<p> </p>
<p>10. Let’s plot the predictions of your initial model to figure out how it really fits the data. Here’s a recipe, using the <code>predict()</code> function. + plot the raw data, using a different colour per <code>FGRAZE</code> level + for each <code>FGRAZE</code> level in turn, + create a sequence of <code>LOGAREA</code> from the minimum value to the maximum within the grazing level (unless you wish to predict outside the range of observed values) + store it in a data frame (e.g. <code>dat4pred</code>) containing the variables <code>FGRAZE</code> and <code>LOGAREA.</code> Remember that <code>FGRAZE</code> is a factor, so it requires quotes. + add a predicted column containing the explanatory variables from the model for the new data frame, using <code>predict()</code> + plot the predictions with the appropriate colours</p>
<p>See the script below, for one of many ways of doing this.</p>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">plot</span>(loyn<span class="op">$</span>ABUND <span class="op">~</span><span class="st"> </span>loyn<span class="op">$</span>LOGAREA, <span class="dt">col =</span> loyn<span class="op">$</span>GRAZE, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Note: # colour 1 means black in R</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># colour 2 means red in R</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># colour 3 means green in R</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># colour 4 means blue in R</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># colour 5 means cyan in R</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># FGRAZE1</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># create a sequence of increasing Biomass within the observed range</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]),</span>
<span id="cb1-12"><a href="#cb1-12"></a>                    <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]),</span>
<span id="cb1-13"><a href="#cb1-13"></a>                    <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co"># create data frame for prediction</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE=</span> <span class="st">&quot;1&quot;</span>, <span class="dt">LOGAREA =</span> LOGAREA.seq)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># predict for new data</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata =</span> dat4pred)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># add the predictions to the plot of the data</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># FGRAZE2</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]),</span>
<span id="cb1-23"><a href="#cb1-23"></a>                    <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]),</span>
<span id="cb1-24"><a href="#cb1-24"></a>                    <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE =</span> <span class="st">&quot;2&quot;</span>, <span class="dt">LOGAREA =</span> LOGAREA.seq)</span>
<span id="cb1-26"><a href="#cb1-26"></a>dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata=</span> dat4pred)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co"># FGRAZE3</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]),</span>
<span id="cb1-31"><a href="#cb1-31"></a>                    <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]),</span>
<span id="cb1-32"><a href="#cb1-32"></a>                    <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb1-33"><a href="#cb1-33"></a>dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE =</span> <span class="st">&quot;3&quot;</span>, <span class="dt">LOGAREA =</span> LOGAREA.seq)</span>
<span id="cb1-34"><a href="#cb1-34"></a>dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata =</span> dat4pred)</span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="co"># FGRAZE4</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]),</span>
<span id="cb1-39"><a href="#cb1-39"></a>                    <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]),</span>
<span id="cb1-40"><a href="#cb1-40"></a>                    <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a>dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE =</span> <span class="st">&quot;4&quot;</span>, <span class="dt">LOGAREA =</span> LOGAREA.seq)</span>
<span id="cb1-42"><a href="#cb1-42"></a>dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata=</span> dat4pred)</span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="co"># FGRAZE5</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]),</span>
<span id="cb1-47"><a href="#cb1-47"></a>                    <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]),</span>
<span id="cb1-48"><a href="#cb1-48"></a>                    <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb1-49"><a href="#cb1-49"></a>dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE =</span> <span class="st">&quot;5&quot;</span>, <span class="dt">LOGAREA =</span> LOGAREA.seq)</span>
<span id="cb1-50"><a href="#cb1-50"></a>dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata =</span> dat4pred)</span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-52"><a href="#cb1-52"></a></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb1-54"><a href="#cb1-54"></a> <span class="dt">legend=</span> <span class="kw">paste</span>(<span class="st">&quot;Graze = &quot;</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">1</span>), </span>
<span id="cb1-55"><a href="#cb1-55"></a> <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb1-56"><a href="#cb1-56"></a> <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb1-57"><a href="#cb1-57"></a> <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_files/figure-html/Q10a-1.png" width="672" /></p>
<p> </p>
<p>[Optional] Alternative method:</p>
<p> </p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Okay, that was a long-winded way of doing this.</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># If, like me, you prefer more compact code and less risks of errors,</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># you can use a loop, to save repeating the sequence 5 times:</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">plot</span>(loyn<span class="op">$</span>ABUND <span class="op">~</span><span class="st"> </span>loyn<span class="op">$</span>LOGAREA, <span class="dt">col =</span> loyn<span class="op">$</span>GRAZE, <span class="dt">pch =</span> <span class="dv">16</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="cf">for</span>(g <span class="cf">in</span> <span class="kw">levels</span>(loyn<span class="op">$</span>FGRAZE)){<span class="co"># `g` will take the values &quot;1&quot;, &quot;2&quot;,..., &quot;5&quot; in turn</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>    LOGAREA.seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb2-9"><a href="#cb2-9"></a>                                        <span class="dt">to =</span> <span class="kw">max</span>(loyn<span class="op">$</span>LOGAREA[loyn<span class="op">$</span>FGRAZE <span class="op">==</span><span class="st"> </span>g]),</span>
<span id="cb2-10"><a href="#cb2-10"></a>                                                        <span class="dt">length =</span> <span class="dv">20</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a>    dat4pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">FGRAZE=</span> g, <span class="dt">LOGAREA=</span> LOGAREA.seq)</span>
<span id="cb2-12"><a href="#cb2-12"></a>    dat4pred<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(birds.add<span class="fl">.1</span>, <span class="dt">newdata=</span> dat4pred)</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="kw">lines</span>(predicted <span class="op">~</span><span class="st"> </span>LOGAREA, <span class="dt">data =</span> dat4pred, <span class="dt">col =</span> <span class="kw">as.numeric</span>(g), <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>}</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb2-16"><a href="#cb2-16"></a> <span class="dt">legend =</span> <span class="kw">paste</span>(<span class="st">&quot;Graze = &quot;</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">1</span>), </span>
<span id="cb2-17"><a href="#cb2-17"></a> <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a> <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb2-19"><a href="#cb2-19"></a> <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="LM_3_multiple_exercise_files/figure-html/Q10b-1.png" width="672" /></p>
<p> </p>
<p>11. What have we learned from this analysis so far?</p>
<p> </p>
<p> </p>
</div>
<div id="part-2-linear-model-with-interactive-explanatory-variables" class="section level3">
<h3>Part 2: Linear model with interactive explanatory variables</h3>
<p> </p>
<p>Let’s now explore this question left unanswered: “is it okay to assume the effect of <code>LOGAREA</code> to be the same for all grazing levels?” This is effectively asking if we should let the slope of <code>LOGAREA</code> vary across <code>FGRAZE</code> levels, which is the definition of an interactive effect.</p>
<p> </p>
<p>12. Fit the corresponding linear model in R to explain the variation in the response variable, <code>ABUND</code> with the explanatory variables <code>LOGAREA</code> and <code>FGRAZE</code> and the interaction between these variables. Hint: this time, the interaction is included using the <code>*</code> symbol instead of <code>+</code>. Remember to use the <code>data =</code> argument. Assign this linear model to an appropriately named object, like <code>birds.inter.1</code>.</p>
<p> </p>
<p> </p>
<p>13. Produce the ANOVA table using the <code>anova()</code> function on the model object. What null hypotheses are being tested? Hint: the <code>anova()</code> function performs sequential tests. Which of these hypotheses are relevant to us? Do you reject or fail to reject the null hypotheses?</p>
<p> </p>
<p> </p>
<p>14. Use the <code>summary()</code> function on the model object to produce the table of parameter estimates. Using this output take each line in turn and answer the following questions: (A) what does this parameter represent, mathematically? (B) What is the biological interpretation of the corresponding estimate? (C) What is the null hypothesis associated with it? (D) Do you reject or fail to reject this hypothesis?</p>
<p> </p>
<p> </p>
<p>15. Now let’s check the assumptions of your linear model by creating plots of the residuals from the model. Remember, that you can split your plotting device into 2 rows and 2 columns using the <code>par()</code> function before you create the plots. Check each of the assumptions using these plots and report whether your model meets these assumptions.</p>
<p> </p>
<p> </p>
<p>16. Let’s now plot the predictions of the interactive model to figure out how it really fits the data. Hint: the script from question 11 should work all the same, since the predictor variables involved in the equation are the same. Don’t forget to update the name of the model!</p>
<p> </p>
<p> </p>
<p>17. Do you think the model is biologically plausible? Is it supported statistically?</p>
<p> </p>
<p> </p>
<p>End of the Linear model with continuous and categorical explanatory variables exercise</p>
<p><br />
</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
