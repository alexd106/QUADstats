<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercises</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">QUADstats</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-book"></span>
         
        Exercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-book"></span>
         
        Exercise Solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/Hpa731UbceQ9pzJu6">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="https://www.quadrat.ac.uk/">
        <span class="fa fa-chrome"></span>
         
        QUADRAT
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/QUADstats">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Exercises</h1>

</div>


<p> </p>
<div
id="exercise-linear-model-with-single-continuous-explanatory-variable"
class="section level2">
<h2>Exercise: Linear model with single continuous explanatory
variable</h2>
<p> </p>
<p>1. Either create a new R script (perhaps call it linear_model_1) or
continue with your previous data exploration R script in your RStudio
Project. Again, make sure you include any metadata you feel is
appropriate (title, description of task, date of creation etc) and don’t
forget to comment out your metadata with a <code>#</code> at the
beginning of the line.</p>
<p> </p>
<p>2. Import the data file ‘loyn.txt’ into R and take a look at the
summary of the graphical data exploration you performed during the
previous exercise. The aim of this exercise is to get familiar with
fitting a simple linear model with a continuous response variable, bird
abundance (<code>ABUND</code>) and a single continuous explanatory
variable forest area (<code>AREA</code>) in R. Ignore the other
explanatory variables for now.</p>
<p> </p>
<p>3. Create a scatterplot of bird abundance and forest patch area to
remind yourself what this relationship looks like. Remember you may have
to transform the <code>AREA</code> variable, return to your data
exploration if in doubt. Try to remember which is your response variable
(y axis) and which is your explanatory variable (x axis). Now fit an
appropriate linear model to describe this relationship using the
<code>lm()</code> function. Remember to use the <code>data =</code>
argument. Assign this linear model to an appropriately named object
(<code>loyn.lm</code> if you imagination fails you!).</p>
<p> </p>
<p>4. Obtain the ANOVA table by using the <code>anova()</code> function
on your model object. What is the null hypothesis you are testing here?
Do you reject or fail to reject this null hypothesis? Explore the ANOVA
table and make sure you understand the different components. Refer back
to the lectures if you need to remind yourself or ask an instructor to
take you through it.</p>
<p> </p>
<p>5. Now display the table of parameter estimates using the
<code>summary()</code> function on your model object. Again, make sure
you understand the different components of this output and be sure to
ask if in doubt. What is the estimate of the intercept and slope? Write
down the word equation of this linear model including your parameter
estimates (hint: think y = a + bx).</p>
<p> </p>
<p>6. What is the null hypothesis associated with the intercept? What is
the null hypothesis associated with the slope? Do you reject or fail to
reject these hypotheses?</p>
<p> </p>
<p>7. Looking again at the output from the <code>summary()</code>
function how much variation in bird abundance is explained by your log
transformed <code>AREA</code> variable?</p>
<p> </p>
<p>8. Now onto a really important part of the model fitting process.
Let’s check the assumptions of your linear model by creating plots of
the residuals from the model. Remember, you can easily create these
plots by using the <code>plot()</code> function on your model object
(<code>loyn.lm</code> or whatever you called it). Also remember that if
you want to see all plots at once then you should split your plotting
device into 2 rows and 2 columns using the <code>par()</code> function
before you create the plots (<a
href="https://intro2r.com/mult_graphs.html#mult_graphs">Section
4.4</a>). Can you remember which plot is used to check the assumption of
normality of the residuals? What is you assessment of this assumption?
Next, check the homogeneity of variance of residuals assumption. Can you
see any patterns in the residuals versus fitted value plots? Is there
more or less equal spread of the residuals? Finally, take a look at the
leverage and Cooks distance plot to assess whether you have any
unusually large or small residuals or any influential residuals. What is
your assessment? Write a couple of sentences to summarise your
assessment of the modelling assumptions as a comment in your R code.</p>
<p> </p>
<p>9. Using your word equation from Question 5, how many birds do you
predict if <code>AREA</code> is 100 from your model?</p>
<p> </p>
<p>10. Calculate the fitted values from your model using the
<code>predict()</code> function and store these predicted values in an
object called <code>pred.vals</code>. Remember, you will first need to
create a dataframe object containing the values of log transformed
<code>AREA</code> you want to make predictions from. Refer back to the
model interpretation video if you need a quick reminder of how to do
this. Ask an instructor to take you through it if you’re in any doubt
(they’d be happy to take you through it).</p>
<p> </p>
<p>11. Now, use the <code>plot()</code> function to plot the
relationship between bird abundance (<code>ABUND</code>) and your log
transformed <code>AREA</code> variable. Also add some axes labels to aid
interpretation of the plot. Once you’ve created the plot then add the
fitted values calculated in Question 10 as a line on the plot (you will
need to use the <code>lines()</code> function to do this but only after
you have created the plot).</p>
<p> </p>
<p>12. OK, this is an optional question so feel free to skip if you’ve
had enough! (you can find the R code for this question in the exercise
solutions if you want to refer to it at a later date). Let’s recreate
the plot you made in Question 11, but this time we’ll add the 95%
confidence intervals in addition to the fitted values. Remember, you
will need to use the <code>predict()</code> function again but this time
include the<code>se.fit = TRUE</code> argument (store these new values
in a new object called <code>pred.vals.se</code>). When you use the
<code>se.fit = TRUE</code> argument with the <code>predict()</code>
function the returned object will have a slightly different structure
compared to when you used it before. Use the <code>str()</code> function
on the <code>pred.vals.se</code> to take a look at the structure. See if
you can figure out how to access the fitted values and the standard
errors. Once you’ve got your head around this you can now use the
<code>lines()</code> function three times to add the fitted values (as
before) and also the upper and lower 95% confidence intervals. Don’t
forget, if you want the 95% confidence intervals then you will need to
multiple your standard error values by the critical value of 1.96. Take
a look at the video on confidence intervals if you are unclear why you
need to do this.</p>
<p> </p>
<p>13. And another optional question (honestly, it’s optional!). This
time plot the relationship between bird abundance (<code>ABUND</code>)
and the original untransformed <code>AREA</code> variable. Now
back-transform your fitted values (remember you got these with the
<code>predict()</code> function) to the original scale and add these to
the plot as a line. Hint 1: you don’t need to reuse the
<code>predict()</code> function, you just need to back-transform your
<code>LOGAREA</code> values. Hint 2: remember if you used a
log<sub>10</sub> transformation (<code>log10()</code>) then you can
back-transform using <code>10^LOGAREA</code> and if you used a natural
log transformation then use <code>exp(LOGAREA)</code> to back-transform.
Comment on the differences between the plot on the transformed (log)
scale and the plot on the back-transformed scale in your R script.</p>
<p> </p>
<p>End of the linear model with single continuous explanatory variable
exercise</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
